<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MacGyver ì‚¬ì´íŠ¸</title>

    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background: #f5f5f5;
        }

        .navbar {
            width: 100%;
            height: 60px;
            background: #222;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            box-sizing: border-box;
        }

        .navbar .title {
            font-size: 22px;
            font-weight: bold;
        }

        .nav-buttons {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .nav-buttons a, .nav-buttons button {
            color: white;
            text-decoration: none;
            font-size: 15px;
            padding: 8px 12px;
            border-radius: 5px;
            background: #3a3a3a;
            border: none;
            cursor: pointer;
        }

        .nav-buttons a:hover, .nav-buttons button:hover {
            background: #555;
        }

        .hero {
            max-width: 900px;
            margin: 60px auto 30px;
            text-align: center;
            padding: 0 16px;
        }

        .hero h1 {
            font-size: 34px;
            margin-bottom: 12px;
        }

        .hero p {
            font-size: 16px;
            color: #555;
            margin-bottom: 28px;
        }

        .hero-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 14px;
        }

        .hero-buttons a {
            text-decoration: none;
            padding: 12px 20px;
            border-radius: 999px;
            font-size: 15px;
            font-weight: bold;
            border: none;
            cursor: pointer;
            min-width: 200px;
            text-align: center;
        }

        .btn-primary {
            background: #0066ff;
            color: #fff;
        }

        .btn-primary:hover {
            background: #0050c1;
        }

        .btn-secondary {
            background: #ffffff;
            color: #333;
            border: 1px solid #ccc;
        }

        .btn-secondary:hover {
            background: #f0f0f0;
        }

        .section {
            max-width: 900px;
            margin: 20px auto 60px;
            padding: 0 16px;
        }

        .section h2 {
            font-size: 20px;
            margin-bottom: 10px;
        }

        .section pre.sample {
            background: #111;
            color: #0f0;
            border-radius: 8px;
            padding: 12px;
            font-family: "Consolas", "Courier New", monospace;
            font-size: 12px;
            white-space: pre;
            overflow: auto;
        }
    </style>
</head>
<body>

<div class="navbar">
    <div class="title">MacGyver ì‚¬ì´íŠ¸</div>
    <div class="nav-buttons" id="nav-user-area"></div>
</div>

<div class="hero">
    <h1>ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ë¥¼ ASCII ì•„íŠ¸ë¡œ</h1>
    <p>
        MacGyver ì‚¬ì´íŠ¸ëŠ” í…ìŠ¤íŠ¸/ì´ë¯¸ì§€ ê¸°ë°˜ ASCII ì•„íŠ¸ë¥¼ ë§Œë“¤ê³  ê³µìœ í•˜ëŠ” ì‘ì€ ê°¤ëŸ¬ë¦¬ì…ë‹ˆë‹¤.<br>
        ì‘í’ˆì„ ì—…ë¡œë“œí•˜ê³ , ë‹¤ë¥¸ ì‚¬ëŒë“¤ì˜ ASCII ì‘í’ˆì„ êµ¬ê²½í•´ë³´ì„¸ìš”.
    </p>

    <div class="hero-buttons">
        <a href="/ascii/list" class="btn-primary">ğŸ¨ ASCII ê°¤ëŸ¬ë¦¬ ë³´ê¸°</a>
        <a href="/ascii/create" class="btn-primary" onclick="return goCreate(event)">âœï¸ ë‚´ ì‘í’ˆ ì—…ë¡œë“œ</a>
        <!-- ë‚˜ì¤‘ì— ì¶”ê°€í•  ì´ë¯¸ì§€â†’ASCII ê¸°ëŠ¥ìš© ë§í¬ (ì§€ê¸ˆì€ ì¤€ë¹„ì¤‘ í˜ì´ì§€ë¡œ ì—°ê²°í•´ë„ ë¨) -->
        <a href="/asciiart" class="btn-secondary">ğŸ–¼ ì´ë¯¸ì§€ â†’ ASCII</a>
    </div>
</div>

<div class="section">
    <h2>ìƒ˜í”Œ ASCII</h2>
    <pre class="sample">
  /\_/\
 ( o.o )
  > ^ <
    </pre>
</div>

<script>
        async function goCreate(e) {
            e.preventDefault();

        try {
            const res = await fetch("/api/auth/me", { method: "GET", credentials: "include" });

        if (!res.ok) {
            alert("ì‘í’ˆì„ ì˜¬ë¦¬ë ¤ë©´ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
            location.href = "/login";
        return false;
        }

        location.href = "/ascii/create";
         return false;
            } catch (err) {
            alert("ì„œë²„ì™€ í†µì‹  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
            return false;
            }
        }
async function setupNavbar() {
const area = document.getElementById("nav-user-area");
const path = window.location.pathname;

if (path === "/login" || path === "/newbody") {
area.innerHTML = `<a href="/">í™ˆìœ¼ë¡œ</a>`;
return;
}

try {
const res = await fetch("/api/auth/me", {
  method: "GET",
  credentials: "include"
});

if (!res.ok) throw new Error();

const text = await res.text();
const email = text.replace("í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì: ", "");

area.innerHTML = `
  <span style="font-weight:bold;">${email}</span>
  <button onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
`;
} catch (e) {
area.innerHTML = `
  <a href="/login">ë¡œê·¸ì¸</a>
  <a href="/newbody">íšŒì›ê°€ì…</a>
`;
}
}

function getCsrfTokenFromCookie() {
const cookie = document.cookie
.split('; ')
.find(row => row.startsWith('XSRF-TOKEN='));
return cookie ? cookie.split('=')[1] : null;
}

async function logout() {
const token = getCsrfTokenFromCookie();

await fetch("/api/auth/logout", {
method: "POST",
headers: { "X-XSRF-TOKEN": token },
credentials: "include"
});

location.href = "/";
}

window.onload = setupNavbar;
</script>

</body>
</html>